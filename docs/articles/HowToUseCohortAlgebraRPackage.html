<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How to Use CohortExplorer R Package • CohortExplorer</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How to Use CohortExplorer R Package">
<meta property="og:description" content="CohortExplorer">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CohortExplorer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/HowToUseCohortExplorerRPackage.html">How to Use CohortExplorer R Package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://ohdsi.github.io/Hades" class="external-link"><img src='https://ohdsi.github.io/Hades/images/hadesMini.png' width=80 height=17 style='vertical-align: top;'></a>
</li>
<li>
  <a href="https://github.com/OHDSI/CohortExplorer/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>How to Use CohortExplorer R Package</h1>
                        <h4 data-toc-skip class="author">Gowtham A.
Rao</h4>
            
            <h4 data-toc-skip class="date">2022-09-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/OHDSI/CohortExplorer/blob/HEAD/vignettes/HowToUseCohortExplorerRPackage.Rmd" class="external-link"><code>vignettes/HowToUseCohortExplorerRPackage.Rmd</code></a></small>
      <div class="hidden name"><code>HowToUseCohortExplorerRPackage.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>(This package is NOT part of HADES.)</p>
<p>The idea behind this package is to allow the construction of new
cohorts from previously instantiated cohorts in the cohort table. All
cohorts in OHDSI have a standard definition: “A cohort is a set of
persons who satisfy one or more inclusion criteria for a duration of
time.”</p>
<ul>
<li>One person may belong to multiple cohorts</li>
<li>One person may belong to the same cohort for multiple different time
periods</li>
<li>One person may not belong to the same cohort multiple times during
the same period of time</li>
<li>A cohort may have zero or more members</li>
</ul>
<p>This is represented in a cohort table as cohort_definition_id,
subject_id, cohort_start_date and cohort_end_date. For more details
about the concept of a cohort please review <a href="https://github.com/OHDSI/TheBookOfOhdsi" class="external-link">The Book of
OHDSI</a>.</p>
<p>This package allows the creation of new cohorts from previously
instantiated cohort table using cohort algebra (similar to temporal set
algebra). The output is one or more new cohorts.</p>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<ul>
<li>This is an installable R-package that may be installed as
follows:</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"OHDSI/CohortExplorer"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre>
<pre><code><span><span class="co">#&gt; Consider adding `DATABASECONNECTOR_JAR_FOLDER='D:/windows_temp/AppData/Local/Temp/rtemp\RtmpOKgazr\jdbcDrivers20a853c01b21'` to C:/Users/admin_grao9/Documents/.Renviron and restarting R.</span></span>
<span><span class="co">#&gt; DatabaseConnector postgresql JDBC driver downloaded to 'D:/windows_temp/AppData/Local/Temp/rtemp\RtmpOKgazr\jdbcDrivers20a853c01b21'.</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="cohort-union">Cohort UNION<a class="anchor" aria-label="anchor" href="#cohort-union"></a>
</h3>
<ul>
<li>Given two or more cohorts, an UNION operator on these cohorts
creates a new cohort with continuous days the persons was present in any
of the cohorts. For example: given a cohort table as follows</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  1         1 2022-01-01      2022-03-01   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>                  2         1 2022-02-10      2022-05-10   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>                  2         1 2022-08-15      2022-12-30</span></span></code></pre>
<pre><code><span><span class="co">#&gt; Connecting using PostgreSQL driver</span></span></code></pre>
<p>The union of the two cohorts is expected to give us</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohortExpected</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  3         1 2022-01-01      2022-05-10   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>                  3         1 2022-08-15      2022-12-30</span></span></code></pre>
<p><img src="CohortUnion.png" alt="Cohort Union"> To perform Cohort
Union, we use the unionCohorts function. This function requires as an
input a data.frame called oldToNewCohortId. Here we specify the cohort
id’s of the cohorts we want to union. The newCohortId is the cohortId of
the resultant cohort. The oldCohortId are cohorts that are already in
the cohort table.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oldToNewCohortId</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>oldCohortId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                newCohortId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">CohortExplorer</span><span class="fu">::</span><span class="fu"><a href="../reference/unionCohorts.html">unionCohorts</a></span><span class="op">(</span></span>
<span>  connection <span class="op">=</span> <span class="va">connection</span>,</span>
<span>  cohortDatabaseSchema <span class="op">=</span> <span class="va">cohortDatabaseSchema</span>,</span>
<span>  cohortTable <span class="op">=</span> <span class="va">tableName</span>,</span>
<span>  oldToNewCohortId <span class="op">=</span> <span class="va">oldToNewCohortId</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now we will have a new cohortId ‘3’ which is the union of cohortId’s
1 and 2.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  3         1 2022-01-01      2022-05-10   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>                  3         1 2022-08-15      2022-12-30</span></span></code></pre>
<p>Note: if the target cohort table had a cohort with cohortId = 3,
before running the union function - this would cause a conflict. In
those cases, the union function would not run. We can purge all records
for cohortId = 3 from the target cohort table. The parameter
purgeConflicts will delete any cohort records in the cohort table where
cohortId is the cohortId of the newCohort.</p>
</div>
<div class="section level3">
<h3 id="intersect-cohort">InterSect Cohort<a class="anchor" aria-label="anchor" href="#intersect-cohort"></a>
</h3>
<ul>
<li>Given two or more cohorts, an INTERSECT operator on these cohorts
creates a new cohort with continuous days the persons was present in ALL
of the cohorts.</li>
</ul>
<div class="section level4">
<h4 id="intersect-cohort-example-1">Intersect cohort example 1<a class="anchor" aria-label="anchor" href="#intersect-cohort-example-1"></a>
</h4>
<p>Input:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  1         1 2022-01-01      2022-01-15   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>                  2         1 2021-12-15      2022-01-30</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">CohortExplorer</span><span class="fu">::</span><span class="fu"><a href="../reference/intersectCohorts.html">intersectCohorts</a></span><span class="op">(</span></span>
<span>  connection <span class="op">=</span> <span class="va">connection</span>,</span>
<span>  cohortDatabaseSchema <span class="op">=</span> <span class="va">cohortDatabaseSchema</span>,</span>
<span>  cohortTable <span class="op">=</span> <span class="va">tableName</span>,</span>
<span>  cohortIds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  newCohortId <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Currently in a tryCatch or withCallingHandlers block, so unable to add global calling handlers. ParallelLogger will not capture R messages, errors, and warnings, only explicit calls to ParallelLogger.</span></span>
<span><span class="co">#&gt; Currently in a tryCatch or withCallingHandlers block, so unable to add global calling handlers. ParallelLogger will not capture R messages, errors, and warnings, only explicit calls to ParallelLogger.</span></span></code></pre>
<div class="figure">
<img src="IntersectExample1.PNG" alt=""><p class="caption">Cohort Intersect 1</p>
</div>
<p>Output</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  3         1 2022-01-01      2022-01-15</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="intersect-cohort-example-2">Intersect cohort example 2<a class="anchor" aria-label="anchor" href="#intersect-cohort-example-2"></a>
</h4>
<p>Input:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  1         1 2022-01-01      2022-01-15   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>                  2         1 2021-12-15      2022-01-05   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>                  2         1 2022-01-10      2022-01-30</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">CohortExplorer</span><span class="fu">::</span><span class="fu"><a href="../reference/intersectCohorts.html">intersectCohorts</a></span><span class="op">(</span></span>
<span>  connection <span class="op">=</span> <span class="va">connection</span>,</span>
<span>  cohortDatabaseSchema <span class="op">=</span> <span class="va">cohortDatabaseSchema</span>,</span>
<span>  cohortTable <span class="op">=</span> <span class="va">tableName</span>,</span>
<span>  cohortIds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  newCohortId <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Currently in a tryCatch or withCallingHandlers block, so unable to add global calling handlers. ParallelLogger will not capture R messages, errors, and warnings, only explicit calls to ParallelLogger.</span></span>
<span><span class="co">#&gt; Currently in a tryCatch or withCallingHandlers block, so unable to add global calling handlers. ParallelLogger will not capture R messages, errors, and warnings, only explicit calls to ParallelLogger.</span></span></code></pre>
<div class="figure">
<img src="IntersectExample2.PNG" alt=""><p class="caption">Cohort Intersect 2</p>
</div>
<p>Output</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  3         1 2022-01-01      2022-01-05   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>                  3         1 2022-01-10      2022-01-15</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="intersect-cohort-example-3">Intersect cohort example 3<a class="anchor" aria-label="anchor" href="#intersect-cohort-example-3"></a>
</h4>
<p>Input:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  1         1 2022-01-01      2022-01-15   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>                  2         1 2021-12-15      2022-01-30   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>                  3         1 2022-03-01      2022-03-15</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">CohortExplorer</span><span class="fu">::</span><span class="fu"><a href="../reference/intersectCohorts.html">intersectCohorts</a></span><span class="op">(</span></span>
<span>  connection <span class="op">=</span> <span class="va">connection</span>,</span>
<span>  cohortDatabaseSchema <span class="op">=</span> <span class="va">cohortDatabaseSchema</span>,</span>
<span>  cohortTable <span class="op">=</span> <span class="va">tableName</span>,</span>
<span>  cohortIds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  newCohortId <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Currently in a tryCatch or withCallingHandlers block, so unable to add global calling handlers. ParallelLogger will not capture R messages, errors, and warnings, only explicit calls to ParallelLogger.</span></span>
<span><span class="co">#&gt; Currently in a tryCatch or withCallingHandlers block, so unable to add global calling handlers. ParallelLogger will not capture R messages, errors, and warnings, only explicit calls to ParallelLogger.</span></span></code></pre>
<div class="figure">
<img src="IntersectExample3.PNG" alt=""><p class="caption">Cohort Intersect 3</p>
</div>
<p>Output</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 0 x 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ... with 4 variables: cohortDefinitionId &lt;dbl&gt;, subjectId &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   cohortStartDate &lt;date&gt;, cohortEndDate &lt;date&gt;</span></span></span></code></pre>
</div>
<div class="section level4">
<h4 id="intersect-cohort-example-4">Intersect cohort example 4<a class="anchor" aria-label="anchor" href="#intersect-cohort-example-4"></a>
</h4>
<p>Input:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  1         1 2022-01-01      2022-01-15   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>                  2         1 2021-12-15      2022-01-30</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">CohortExplorer</span><span class="fu">::</span><span class="fu"><a href="../reference/intersectCohorts.html">intersectCohorts</a></span><span class="op">(</span></span>
<span>  connection <span class="op">=</span> <span class="va">connection</span>,</span>
<span>  cohortDatabaseSchema <span class="op">=</span> <span class="va">cohortDatabaseSchema</span>,</span>
<span>  cohortTable <span class="op">=</span> <span class="va">tableName</span>,</span>
<span>  cohortIds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  newCohortId <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Currently in a tryCatch or withCallingHandlers block, so unable to add global calling handlers. ParallelLogger will not capture R messages, errors, and warnings, only explicit calls to ParallelLogger.</span></span>
<span><span class="co">#&gt; Currently in a tryCatch or withCallingHandlers block, so unable to add global calling handlers. ParallelLogger will not capture R messages, errors, and warnings, only explicit calls to ParallelLogger.</span></span></code></pre>
<div class="figure">
<img src="IntersectExample4.PNG" alt=""><p class="caption">Cohort Intersect 4</p>
</div>
<p>Output</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 0 x 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ... with 4 variables: cohortDefinitionId &lt;dbl&gt;, subjectId &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   cohortStartDate &lt;date&gt;, cohortEndDate &lt;date&gt;</span></span></span></code></pre>
</div>
<div class="section level4">
<h4 id="intersect-cohort-example-5">Intersect cohort example 5<a class="anchor" aria-label="anchor" href="#intersect-cohort-example-5"></a>
</h4>
<p>Input:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  1         1 2022-01-01      2022-01-01   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>                  2         1 2022-01-01      2022-01-02</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">CohortExplorer</span><span class="fu">::</span><span class="fu"><a href="../reference/intersectCohorts.html">intersectCohorts</a></span><span class="op">(</span></span>
<span>  connection <span class="op">=</span> <span class="va">connection</span>,</span>
<span>  cohortDatabaseSchema <span class="op">=</span> <span class="va">cohortDatabaseSchema</span>,</span>
<span>  cohortTable <span class="op">=</span> <span class="va">tableName</span>,</span>
<span>  cohortIds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  newCohortId <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Currently in a tryCatch or withCallingHandlers block, so unable to add global calling handlers. ParallelLogger will not capture R messages, errors, and warnings, only explicit calls to ParallelLogger.</span></span>
<span><span class="co">#&gt; Currently in a tryCatch or withCallingHandlers block, so unable to add global calling handlers. ParallelLogger will not capture R messages, errors, and warnings, only explicit calls to ParallelLogger.</span></span></code></pre>
<div class="figure">
<img src="IntersectExample5.PNG" alt=""><p class="caption">Cohort Intersect 5</p>
</div>
<p>Output</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  3         1 2022-01-01      2022-01-01</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="minus-cohort">Minus Cohort<a class="anchor" aria-label="anchor" href="#minus-cohort"></a>
</h3>
<p>Input:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  1         1 2022-01-01      2022-03-01   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>                  2         1 2022-02-10      2022-05-10</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">CohortExplorer</span><span class="fu">::</span><span class="fu"><a href="../reference/minusCohorts.html">minusCohorts</a></span><span class="op">(</span></span>
<span>  connection <span class="op">=</span> <span class="va">connection</span>,</span>
<span>  cohortDatabaseSchema <span class="op">=</span> <span class="va">cohortDatabaseSchema</span>,</span>
<span>  cohortTable <span class="op">=</span> <span class="va">tableName</span>,</span>
<span>  firstCohortId <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  secondCohortId <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  newCohortId <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Currently in a tryCatch or withCallingHandlers block, so unable to add global calling handlers. ParallelLogger will not capture R messages, errors, and warnings, only explicit calls to ParallelLogger.</span></span>
<span><span class="co">#&gt; Currently in a tryCatch or withCallingHandlers block, so unable to add global calling handlers. ParallelLogger will not capture R messages, errors, and warnings, only explicit calls to ParallelLogger.</span></span></code></pre>
<div class="figure">
<img src="MinusExample1.PNG" alt=""><p class="caption">Cohort Minus</p>
</div>
<p>Output for example 1</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  3         1 2022-01-01      2022-02-09</span></span></code></pre>
<p>But if the cohorts are switched, i.e. minus cohort 1 from Cohort
2</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">CohortExplorer</span><span class="fu">::</span><span class="fu"><a href="../reference/minusCohorts.html">minusCohorts</a></span><span class="op">(</span></span>
<span>  connection <span class="op">=</span> <span class="va">connection</span>,</span>
<span>  cohortDatabaseSchema <span class="op">=</span> <span class="va">cohortDatabaseSchema</span>,</span>
<span>  cohortTable <span class="op">=</span> <span class="va">tableName</span>,</span>
<span>  firstCohortId <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  secondCohortId <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  newCohortId <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Currently in a tryCatch or withCallingHandlers block, so unable to add global calling handlers. ParallelLogger will not capture R messages, errors, and warnings, only explicit calls to ParallelLogger.</span></span>
<span><span class="co">#&gt; Currently in a tryCatch or withCallingHandlers block, so unable to add global calling handlers. ParallelLogger will not capture R messages, errors, and warnings, only explicit calls to ParallelLogger.</span></span></code></pre>
<div class="figure">
<img src="MinusExample2.PNG" alt=""><p class="caption">Cohort Minus</p>
</div>
<p>Output</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  4         1 2022-03-02      2022-05-10</span></span></code></pre>
<p>Sequence of cohorts are important for minusCohort</p>
</div>
<div class="section level3">
<h3 id="modify-cohort">Modify Cohort<a class="anchor" aria-label="anchor" href="#modify-cohort"></a>
</h3>
<p>Sometimes there is a need to modify a previously instantiated
cohorts. Modification may be censoring (left or right) based on calendar
date. This may be done using modifyCohort as follows:</p>
<pre><code><span><span class="co">#&gt; Connecting using PostgreSQL driver</span></span></code></pre>
<div class="section level4">
<h4 id="example-1-modify-cohort-based-on-calendar-date-censoring-">Example 1: Modify cohort based on calendar date censoring.<a class="anchor" aria-label="anchor" href="#example-1-modify-cohort-based-on-calendar-date-censoring-"></a>
</h4>
<p>Let us say we have a simple cohort as follows:</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  1         1 1999-01-01      1999-01-31</span></span></code></pre>
<p>We can censor the dates (left, right, or both). Parameter
<code>cohortStartCensorDate</code> performs left censor, while
<code>cohortEndEndCensorDate</code> performs right censor. This function
is useful if you need to force exit based on calendar dates.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu">CohortExplorer</span><span class="fu">::</span><span class="fu"><a href="../reference/modifyCohort.html">modifyCohort</a></span><span class="op">(</span></span>
<span>    connection <span class="op">=</span> <span class="va">connection</span>,</span>
<span>    cohortDatabaseSchema <span class="op">=</span> <span class="va">cohortDatabaseSchema</span>,</span>
<span>    cohortTable <span class="op">=</span> <span class="va">tableName</span>,</span>
<span>    oldCohortId <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    newCohortId <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    cohortStartCensorDate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1999-01-05"</span><span class="op">)</span>,  <span class="co"># for left censor</span></span>
<span>    cohortEndCensorDate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1999-01-25"</span><span class="op">)</span>     <span class="co"># for right censor</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Currently in a tryCatch or withCallingHandlers block, so unable to add global calling handlers. ParallelLogger will not capture R messages, errors, and warnings, only explicit calls to ParallelLogger.</span></span></code></pre>
<p>Gives the following output</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  2         1 1999-01-05      1999-01-25</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="example-2-modify-cohort-by-filtering-cohort-records-by-date-range-">Example 2: Modify cohort by filtering cohort records by date
range.<a class="anchor" aria-label="anchor" href="#example-2-modify-cohort-by-filtering-cohort-records-by-date-range-"></a>
</h4>
<p>We can also filter an instantiated cohort and create a new cohort by
filtering the original cohort by date ranges. This may be applied to
cohort_start_date, cohort_end_date or both. Lets take this cohort as an
example:</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  3         3 2010-01-01      2010-01-05   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>                  3         3 1999-01-15      1999-01-25</span></span></code></pre>
<p>We can filter by cohort_start_date using the parameter
cohortStartFilterRange as follows:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu">CohortExplorer</span><span class="fu">::</span><span class="fu"><a href="../reference/modifyCohort.html">modifyCohort</a></span><span class="op">(</span></span>
<span>    connection <span class="op">=</span> <span class="va">connection</span>,</span>
<span>    cohortDatabaseSchema <span class="op">=</span> <span class="va">cohortDatabaseSchema</span>,</span>
<span>    cohortTable <span class="op">=</span> <span class="va">tableName</span>,</span>
<span>    oldCohortId <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    newCohortId <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    cohortStartFilterRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1998-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1999-12-31"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    purgeConflicts <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Currently in a tryCatch or withCallingHandlers block, so unable to add global calling handlers. ParallelLogger will not capture R messages, errors, and warnings, only explicit calls to ParallelLogger.</span></span></code></pre>
<p>Gives the following output. Note only records where the
cohort_start_date was within the given date range became cohortId 2.</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  2         3 1999-01-15      1999-01-25</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="example-3-pad-cohorts-by-addingsubstracting-days-from-cohort-start-or-end-date-">Example 3: Pad cohorts by adding/substracting days from cohort start
or end date.<a class="anchor" aria-label="anchor" href="#example-3-pad-cohorts-by-addingsubstracting-days-from-cohort-start-or-end-date-"></a>
</h4>
<p>We can add or subtracts days to an instantiated cohort and create a
new cohort. Lets take this cohort as an example:</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  1         1 1999-01-01      1999-01-31</span></span></code></pre>
<p>We can pad days as follows:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu">CohortExplorer</span><span class="fu">::</span><span class="fu"><a href="../reference/modifyCohort.html">modifyCohort</a></span><span class="op">(</span></span>
<span>    connection <span class="op">=</span> <span class="va">connection</span>,</span>
<span>    cohortDatabaseSchema <span class="op">=</span> <span class="va">cohortDatabaseSchema</span>,</span>
<span>    cdmDatabaseSchema <span class="op">=</span> <span class="va">cohortDatabaseSchema</span>,</span>
<span>    cohortTable <span class="op">=</span> <span class="va">tableName</span>,</span>
<span>    oldCohortId <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    newCohortId <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    purgeConflicts <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    cohortStartPadDays <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>,</span>
<span>    cohortEndPadDays <span class="op">=</span> <span class="fl">5</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Notes: because padding days may extend cohort period outside the
observation_period (which is not allowed), this function will require
access to the cdmDatabaseSchema and the observation_period table.</p>
</div>
</div>
<div class="section level3">
<h3 id="remove-subjects-from-cohort">Remove subjects from Cohort<a class="anchor" aria-label="anchor" href="#remove-subjects-from-cohort"></a>
</h3>
<p>If you need to remove subjects from one or more cohorts, who are
present in one or more of other cohorts - this can be achieved using
this function.</p>
<pre><code><span><span class="co">#&gt; Connecting using PostgreSQL driver</span></span></code></pre>
<p>lets suppose we have a cohort table with following data:</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  1         1 1999-01-01      1999-01-31   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>                  1         2 2010-01-01      2010-01-05   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>                  3         2 1999-01-15      1999-01-25</span></span></code></pre>
<p>and we decide to remove from cohort id 1, all subjects in cohort id
3, and create a new cohort with cohort id 6.
<code>removeSubjectsFromCohorts</code> can do this.We expect the output
cohort 6, to not have any subjects with subjectId = 2 because subjectId
2 is present in cohort id 3.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu">CohortExplorer</span><span class="fu">::</span><span class="fu"><a href="../reference/removeSubjectsFromCohorts.html">removeSubjectsFromCohorts</a></span><span class="op">(</span></span>
<span>    connection <span class="op">=</span> <span class="va">connection</span>,</span>
<span>    cohortDatabaseSchema <span class="op">=</span> <span class="va">cohortDatabaseSchema</span>,</span>
<span>    oldToNewCohortId <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>oldCohortId <span class="op">=</span> <span class="fl">1</span>, newCohortId <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>    cohortsWithSubjectsToRemove <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>    purgeConflicts <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    cohortTable <span class="op">=</span> <span class="va">tableName</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 x 4</span></span></span>
<span><span class="co">#&gt;   cohortDefinitionId subjectId cohortStartDate cohortEndDate</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                  6         1 1999-01-01      1999-01-31</span></span></code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Gowtham Rao, Adam Black.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
